///Fin_nifty weekly expiry : Thursday was expiry until 14.10.2021 and from 19.10.2021(first) tuesday was the new expiry
///Fin_nifty weeklies started in Jan.2021
///Last updated till 31.01.2023

//finnifty_weeklyexpiry = iif(Datenum()>=1210108 and Datenum()<=1210114,1210114,	iif(Datenum()>=1210115 and Datenum()<=1210121,1210121,	iif(Datenum()>=1210122 and Datenum()<=1210128,1210128,	iif(Datenum()>=1210129 and Datenum()<=1210204,1210204,	iif(Datenum()>=1210205 and Datenum()<=1210211,1210211,	iif(Datenum()>=1210212 and Datenum()<=1210218,1210218,	iif(Datenum()>=1210219 and Datenum()<=1210225,1210225,	iif(Datenum()>=1210226 and Datenum()<=1210304,1210304,	iif(Datenum()>=1210305 and Datenum()<=1210310,1210310,	iif(Datenum()>=1210311 and Datenum()<=1210318,1210318,	iif(Datenum()>=1210319 and Datenum()<=1210325,1210325,	iif(Datenum()>=1210326 and Datenum()<=1210401,1210401,	iif(Datenum()>=1210402 and Datenum()<=1210408,1210408,	iif(Datenum()>=1210409 and Datenum()<=1210415,1210415,	iif(Datenum()>=1210416 and Datenum()<=1210422,1210422,	iif(Datenum()>=1210423 and Datenum()<=1210429,1210429,	iif(Datenum()>=1210430 and Datenum()<=1210506,1210506,	iif(Datenum()>=1210507 and Datenum()<=1210512,1210512,	iif(Datenum()>=1210513 and Datenum()<=1210520,1210520,	iif(Datenum()>=1210521 and Datenum()<=1210527,1210527,	iif(Datenum()>=1210528 and Datenum()<=1210603,1210603,	iif(Datenum()>=1210604 and Datenum()<=1210610,1210610,	iif(Datenum()>=1210611 and Datenum()<=1210617,1210617,	iif(Datenum()>=1210618 and Datenum()<=1210624,1210624,	iif(Datenum()>=1210625 and Datenum()<=1210701,1210701,	iif(Datenum()>=1210702 and Datenum()<=1210708,1210708,	iif(Datenum()>=1210709 and Datenum()<=1210715,1210715,	iif(Datenum()>=1210716 and Datenum()<=1210722,1210722,	iif(Datenum()>=1210723 and Datenum()<=1210729,1210729,	iif(Datenum()>=1210730 and Datenum()<=1210805,1210805,	iif(Datenum()>=1210806 and Datenum()<=1210812,1210812,	iif(Datenum()>=1210813 and Datenum()<=1210819,1210819,	iif(Datenum()>=1210820 and Datenum()<=1210826,1210826,	iif(Datenum()>=1210827 and Datenum()<=1210902,1210902,	iif(Datenum()>=1210903 and Datenum()<=1210909,1210909,	iif(Datenum()>=1210910 and Datenum()<=1210916,1210916,	iif(Datenum()>=1210917 and Datenum()<=1210923,1210923,	iif(Datenum()>=1210924 and Datenum()<=1210930,1210930,	iif(Datenum()>=1211001 and Datenum()<=1211007,1211007,	iif(Datenum()>=1211008 and Datenum()<=1211014,1211014,	iif(Datenum()>=1211015 and Datenum()<=1211019,1211019,	iif(Datenum()>=1211020 and Datenum()<=1211026,1211026,	iif(Datenum()>=1211027 and Datenum()<=1211102,1211102,	iif(Datenum()>=1211103 and Datenum()<=1211109,1211109,	iif(Datenum()>=1211110 and Datenum()<=1211116,1211116,	iif(Datenum()>=1211117 and Datenum()<=1211123,1211123,	iif(Datenum()>=1211124 and Datenum()<=1211130,1211130,	iif(Datenum()>=1211201 and Datenum()<=1211207,1211207,	iif(Datenum()>=1211208 and Datenum()<=1211214,1211214,	iif(Datenum()>=1211215 and Datenum()<=1211221,1211221,	iif(Datenum()>=1211222 and Datenum()<=1211228,1211228,	iif(Datenum()>=1211229 and Datenum()<=1220104,1220104,	iif(Datenum()>=1220105 and Datenum()<=1220111,1220111,	iif(Datenum()>=1220112 and Datenum()<=1220118,1220118,	iif(Datenum()>=1220119 and Datenum()<=1220125,1220125,	iif(Datenum()>=1220126 and Datenum()<=1220201,1220201,	iif(Datenum()>=1220202 and Datenum()<=1220208,1220208,	iif(Datenum()>=1220209 and Datenum()<=1220215,1220215,	iif(Datenum()>=1220216 and Datenum()<=1220222,1220222,	iif(Datenum()>=1220223 and Datenum()<=1220228,1220228,	iif(Datenum()>=1220301 and Datenum()<=1220308,1220308,	iif(Datenum()>=1220309 and Datenum()<=1220315,1220315,	iif(Datenum()>=1220316 and Datenum()<=1220322,1220322,	iif(Datenum()>=1220323 and Datenum()<=1220329,1220329,	iif(Datenum()>=1220330 and Datenum()<=1220405,1220405,	iif(Datenum()>=1220406 and Datenum()<=1220412,1220412,	iif(Datenum()>=1220413 and Datenum()<=1220419,1220419,	iif(Datenum()>=1220420 and Datenum()<=1220426,1220426,	iif(Datenum()>=1220427 and Datenum()<=1220502,1220502,	iif(Datenum()>=1220503 and Datenum()<=1220510,1220510,	iif(Datenum()>=1220511 and Datenum()<=1220517,1220517,	iif(Datenum()>=1220518 and Datenum()<=1220524,1220524,	iif(Datenum()>=1220525 and Datenum()<=1220531,1220531,	iif(Datenum()>=1220601 and Datenum()<=1220607,1220607,	iif(Datenum()>=1220608 and Datenum()<=1220614,1220614,	iif(Datenum()>=1220615 and Datenum()<=1220621,1220621,	iif(Datenum()>=1220622 and Datenum()<=1220628,1220628,	iif(Datenum()>=1220629 and Datenum()<=1220705,1220705,	iif(Datenum()>=1220706 and Datenum()<=1220712,1220712,	iif(Datenum()>=1220713 and Datenum()<=1220719,1220719,	iif(Datenum()>=1220720 and Datenum()<=1220726,1220726,	iif(Datenum()>=1220727 and Datenum()<=1220802,1220802,	iif(Datenum()>=1220803 and Datenum()<=1220808,1220808,	iif(Datenum()>=1220809 and Datenum()<=1220809,1220809,	iif(Datenum()>=1220810 and Datenum()<=1220816,1220816,	iif(Datenum()>=1220817 and Datenum()<=1220823,1220823,	iif(Datenum()>=1220824 and Datenum()<=1220830,1220830,null)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	);
finnifty_weeklyexpiry= iif(datenum()>=1210101 and datenum()<=1210107,1210107,	iif(datenum()>=1210108 and datenum()<=1210114,1210114,	iif(datenum()>=1210115 and datenum()<=1210121,1210121,	iif(datenum()>=1210122 and datenum()<=1210128,1210128,	iif(datenum()>=1210129 and datenum()<=1210204,1210204,	iif(datenum()>=1210205 and datenum()<=1210211,1210211,	iif(datenum()>=1210212 and datenum()<=1210218,1210218,	iif(datenum()>=1210219 and datenum()<=1210225,1210225,	iif(datenum()>=1210226 and datenum()<=1210304,1210304,	iif(datenum()>=1210305 and datenum()<=1210310,1210310,	iif(datenum()>=1210311 and datenum()<=1210318,1210318,	iif(datenum()>=1210319 and datenum()<=1210325,1210325,	iif(datenum()>=1210326 and datenum()<=1210401,1210401,	iif(datenum()>=1210402 and datenum()<=1210408,1210408,	iif(datenum()>=1210409 and datenum()<=1210415,1210415,	iif(datenum()>=1210416 and datenum()<=1210422,1210422,	iif(datenum()>=1210423 and datenum()<=1210429,1210429,	iif(datenum()>=1210430 and datenum()<=1210506,1210506,	iif(datenum()>=1210507 and datenum()<=1210512,1210512,	iif(datenum()>=1210513 and datenum()<=1210520,1210520,	iif(datenum()>=1210521 and datenum()<=1210527,1210527,	iif(datenum()>=1210528 and datenum()<=1210603,1210603,	iif(datenum()>=1210604 and datenum()<=1210610,1210610,	iif(datenum()>=1210611 and datenum()<=1210617,1210617,	iif(datenum()>=1210618 and datenum()<=1210624,1210624,	iif(datenum()>=1210625 and datenum()<=1210701,1210701,	iif(datenum()>=1210702 and datenum()<=1210708,1210708,	iif(datenum()>=1210709 and datenum()<=1210715,1210715,	iif(datenum()>=1210716 and datenum()<=1210722,1210722,	iif(datenum()>=1210723 and datenum()<=1210729,1210729,	iif(datenum()>=1210730 and datenum()<=1210805,1210805,	iif(datenum()>=1210806 and datenum()<=1210812,1210812,	iif(datenum()>=1210813 and datenum()<=1210818,1210818,	iif(datenum()>=1210819 and datenum()<=1210826,1210826,	iif(datenum()>=1210827 and datenum()<=1210902,1210902,	iif(datenum()>=1210903 and datenum()<=1210909,1210909,	iif(datenum()>=1210910 and datenum()<=1210916,1210916,	iif(datenum()>=1210917 and datenum()<=1210923,1210923,	iif(datenum()>=1210924 and datenum()<=1210930,1210930,	iif(datenum()>=1211001 and datenum()<=1211007,1211007,	iif(datenum()>=1211008 and datenum()<=1211014,1211014,	iif(datenum()>=1211015 and datenum()<=1211019,1211019,	iif(datenum()>=1211020 and datenum()<=1211026,1211026,	iif(datenum()>=1211027 and datenum()<=1211102,1211102,	iif(datenum()>=1211103 and datenum()<=1211109,1211109,	iif(datenum()>=1211110 and datenum()<=1211116,1211116,	iif(datenum()>=1211117 and datenum()<=1211123,1211123,	iif(datenum()>=1211124 and datenum()<=1211130,1211130,	iif(datenum()>=1211201 and datenum()<=1211207,1211207,	iif(datenum()>=1211208 and datenum()<=1211214,1211214,	iif(datenum()>=1211215 and datenum()<=1211221,1211221,	iif(datenum()>=1211222 and datenum()<=1211228,1211228,	iif(datenum()>=1211229 and datenum()<=1220104,1220104,	iif(datenum()>=1220105 and datenum()<=1220111,1220111,	iif(datenum()>=1220112 and datenum()<=1220118,1220118,	iif(datenum()>=1220119 and datenum()<=1220125,1220125,	iif(datenum()>=1220126 and datenum()<=1220201,1220201,	iif(datenum()>=1220202 and datenum()<=1220208,1220208,	iif(datenum()>=1220209 and datenum()<=1220215,1220215,	iif(datenum()>=1220216 and datenum()<=1220222,1220222,	iif(datenum()>=1220223 and datenum()<=1220228,1220228,	iif(datenum()>=1220301 and datenum()<=1220308,1220308,	iif(datenum()>=1220309 and datenum()<=1220315,1220315,	iif(datenum()>=1220316 and datenum()<=1220322,1220322,	iif(datenum()>=1220323 and datenum()<=1220329,1220329,	iif(datenum()>=1220330 and datenum()<=1220405,1220405,	iif(datenum()>=1220406 and datenum()<=1220412,1220412,	iif(datenum()>=1220413 and datenum()<=1220419,1220419,	iif(datenum()>=1220420 and datenum()<=1220426,1220426,	iif(datenum()>=1220427 and datenum()<=1220502,1220502,	iif(datenum()>=1220503 and datenum()<=1220510,1220510,	iif(datenum()>=1220511 and datenum()<=1220517,1220517,	iif(datenum()>=1220518 and datenum()<=1220524,1220524,	iif(datenum()>=1220525 and datenum()<=1220531,1220531,	iif(datenum()>=1220601 and datenum()<=1220607,1220607,	iif(datenum()>=1220608 and datenum()<=1220614,1220614,	iif(datenum()>=1220615 and datenum()<=1220621,1220621,	iif(datenum()>=1220622 and datenum()<=1220628,1220628,	iif(datenum()>=1220629 and datenum()<=1220705,1220705,	iif(datenum()>=1220706 and datenum()<=1220712,1220712,	iif(datenum()>=1220713 and datenum()<=1220719,1220719,	iif(datenum()>=1220720 and datenum()<=1220726,1220726,	iif(datenum()>=1220727 and datenum()<=1220802,1220802,	iif(datenum()>=1220803 and datenum()<=1220808,1220808,	iif(datenum()>=1220809 and datenum()<=1220816,1220816,	iif(datenum()>=1220817 and datenum()<=1220823,1220823,	iif(datenum()>=1220824 and datenum()<=1220830,1220830,	iif(datenum()>=1220831 and datenum()<=1220906,1220906,	iif(datenum()>=1220907 and datenum()<=1220913,1220913,	iif(datenum()>=1220914 and datenum()<=1220920,1220920,	iif(datenum()>=1220921 and datenum()<=1220927,1220927,	iif(datenum()>=1220928 and datenum()<=1221004,1221004,	iif(datenum()>=1221005 and datenum()<=1221011,1221011,	iif(datenum()>=1221012 and datenum()<=1221018,1221018,	iif(datenum()>=1221019 and datenum()<=1221025,1221025,	iif(datenum()>=1221026 and datenum()<=1221101,1221101,	iif(datenum()>=1221102 and datenum()<=1221107,1221107,	iif(datenum()>=1221108 and datenum()<=1221115,1221115,	iif(datenum()>=1221116 and datenum()<=1221122,1221122,	iif(datenum()>=1221123 and datenum()<=1221129,1221129,	iif(datenum()>=1221130 and datenum()<=1221206,1221206,	iif(datenum()>=1221207 and datenum()<=1221213,1221213,	iif(datenum()>=1221214 and datenum()<=1221220,1221220,	iif(datenum()>=1221221 and datenum()<=1221227,1221227,	iif(datenum()>=1221228 and datenum()<=1230103,1230103,	iif(datenum()>=1230104 and datenum()<=1230110,1230110,	iif(datenum()>=1230111 and datenum()<=1230117,1230117,	iif(datenum()>=1230118 and datenum()<=1230124,1230124,	iif(datenum()>=1230125 and datenum()<=1230131,1230131,null					)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	)	);
dte = DateTimeDiff(DateTimeConvert(2,finnifty_weeklyexpiry),DateTimeConvert(2,DateNum()))/(24*60*60);

